#+SETUPFILE: ~/.emacs.d/src/org-templates/level-2.org
#+TITLE: ti816x u-boot
#+OPTIONS: num:nil H:2


* Modify DDR3 Frequency 
** step 1
=arch/arm/include/asm/arch-ti81xx/ddr_defs_ti816x.h=
#+begin_src c
#define CONFIG_TI816X_DDR3_796 /* Values supported 400,531,675,796 */
#+end_src

** step 2
=arch/arm/include/asm/arch-ti81xx/clocks_ti816x.h=
#+begin_src c
#define DDR_PLL_796     /* Values supported 400,531,675,796 */
#+end_src

** step 3
Open the file =include/configs/ti8168_evm.h= and make sure that the
config option for DDR3 is not commented and that for DDR2 is commented
out as shown below
#+begin_src c
[...]
//#define CONFIG_TI816X_EVM_DDR3                  /* Configure DDR3 in U-Boot */
#define CONFIG_TI816X_EVM_DDR2                /* Configure DDR2 in U-Boot */
[...]
#+end_src






* Modify serial console UART port 
=include/configs/ti8168_evm.h=
#+begin_src c
/*
 * NS16550 Configuration
 */
//define CONFIG_SYS_NS16550_COM1		0x48024000	/* Base EVM has UART2 */
define CONFIG_SYS_NS16550_COM1		0x48020000	/* Base EVM has UART0 */
#+end_src

* Files
** =/board/ti/ti8168=
#+begin_src sh
|-- config.mk
|-- evm.c
|-- Makefile
`-- u-boot.lds
#+end_src

** =arch/arm/include/asm/arch-ti81xx/=
#+begin_src sh
|-- clock.h
|-- clocks_ti816x.h
|-- cpu.h
|-- ddr_defs.h
|-- ddr_defs_ti816x.h
|-- emac_defs.h
|-- hardware.h
|-- i2c.h
|-- mem.h
|-- mmc.h
|-- mmc_host_def.h
|-- nand.h
`-- sys_proto.h
#+end_src

** =include/configs/ti8168_evm.h=
** =arch/arm/cpu/arm_cortexa8/ti81xx=
#+begin_src sh
   |-- cache.S
   |-- elm.c
   |-- lowlevel_init.S
   |-- Makefile
   |-- mem.c
   |-- sys_info.c
   |-- syslib.c
   `-- timer.c
#+end_src

* Make
** step1: make the mini u-boot
[[./build_min.sh][build\_min.sh]]
#+include: "./build_min.sh" src sh

** step2: make the normal u-boot
[[./build_sd.sh][build\_sd]]
#+include: "./build_sd.sh" src sh

* Boot from SD Card
