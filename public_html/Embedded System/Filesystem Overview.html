<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Filesystem OverView</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="title" content="Filesystem OverView"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-09-09 15:16:53 HKT"/>
<meta name="author" content="Shi Shougang"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  {margin-left:auto; margin-right:0px;  text-align:right;}
  .left   {margin-left:0px;  margin-right:auto; text-align:left;}
  .center {margin-left:auto; margin-right:auto; text-align:center;}
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top;  }
  th.right  { text-align:center;  }
  th.left   { text-align:center;   }
  th.center { text-align:center; }
  td.right  { text-align:right;  }
  td.left   { text-align:left;   }
  td.center { text-align:center; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  div.inlinetask {
    padding:10px;
    border:2px solid gray;
    margin:10px;
    background: #ffffcc;
  }
  textarea { overflow-x: auto; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style><link rel="stylesheet" href="./assets/stylesheet.css" type="text/css"/>
<link rel="stylesheet" type="text/css" href="../assets/stylesheet.css" />
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>

</head>
<body>
<div id="org-div-home-and-up" style="text-align:right;font-size:70%;white-space:nowrap;">
 <a accesskey="h" href="../index.html"> UP </a>
 |
 <a accesskey="H" href="../index.html"> HOME </a>
</div>

<div id="preamble">

</div>

<div id="content">
<h1 class="title">Filesystem OverView</h1>



<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">General</a>
<ul>
<li><a href="#sec-1-1">arago main page</a></li>
<li><a href="#sec-1-2">busybox</a></li>
<li><a href="#sec-1-3">ubuntu</a></li>
<li><a href="#sec-1-4">OpenEmbedded</a></li>
<li><a href="#sec-1-5">Poky Linux</a></li>
<li><a href="#sec-1-6">Root File system solutions</a></li>
<li><a href="#sec-1-7">Creating a Root File System for Linux on OMAP35x</a></li>
<li><a href="#sec-1-8">Initrd</a></li>
</ul>
</li>
<li><a href="#sec-2">Modify</a>
<ul>
<li><a href="#sec-2-1">Using The Correct Console Device</a></li>
</ul>
</li>
<li><a href="#sec-3">Arago</a>
<ul>
<li><a href="#sec-3-1">Setting Up Build Environment and build</a>
<ul>
<li><a href="#sec-3-1-1">ubuntu install dependency</a></li>
<li><a href="#sec-3-1-2">Create the directory</a></li>
<li><a href="#sec-3-1-3">Clone Arago repositories</a></li>
<li><a href="#sec-3-1-4">Copy setup/config files</a></li>
<li><a href="#sec-3-1-5">Set the environment variables</a></li>
<li><a href="#sec-3-1-6">Point to CSL toolchain</a></li>
<li><a href="#sec-3-1-7">Build a minimal base filesystem</a></li>
<li><a href="#sec-3-1-8">Build a "demo" filesystem for OMAP3 EVM</a></li>
<li><a href="#sec-3-1-9">Build different kernels for supported platforms</a></li>
<li><a href="#sec-3-1-10">High-level hierarchy of arago-deploy directory</a></li>
<li><a href="#sec-3-1-11">Build individual package recipes</a></li>
<li><a href="#sec-3-1-12">build a native compiler (on dm8168) using</a></li>
</ul></li>
</ul>
</li>
<li><a href="#sec-4">Host and Target</a></li>
<li><a href="#sec-5">Notes</a>
<ul>
<li><a href="#sec-5-1">Creating a Root File System for Linux on OMAP35x</a>
<ul>
<li><a href="#sec-5-1-1">create the directory</a></li>
<li><a href="#sec-5-1-2">Configure the Linux Kernel to Support File Systems</a></li>
<li><a href="#sec-5-1-3">Download and Build BusyBox</a></li>
<li><a href="#sec-5-1-4">Configure the New Target Root File System</a></li>
<li><a href="#sec-5-1-5">Add the Shared Libraries Applications will Require</a></li>
<li><a href="#sec-5-1-6">Mounting the Root File System over NFS</a></li>
<li><a href="#sec-5-1-7">Enhancing the Root File System</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">General</h2>
<div class="outline-text-2" id="text-1">


</div>

<div id="outline-container-1-1" class="outline-3">
<h3 id="sec-1-1">arago main page</h3>
<div class="outline-text-3" id="text-1-1">

<p><a href="http://arago-project.org/wiki/index.php/Main_Page">http://arago-project.org/wiki/index.php/Main_Page</a>
</p></div>

</div>

<div id="outline-container-1-2" class="outline-3">
<h3 id="sec-1-2">busybox</h3>
<div class="outline-text-3" id="text-1-2">

<p><a href="http://www.busybox.net/">http://www.busybox.net/</a>
</p></div>

</div>

<div id="outline-container-1-3" class="outline-3">
<h3 id="sec-1-3">ubuntu</h3>
<div class="outline-text-3" id="text-1-3">

<p><a href="https://wiki.ubuntu.com/ARM/RootfsFromScratch">https://wiki.ubuntu.com/ARM/RootfsFromScratch</a>
</p></div>

</div>

<div id="outline-container-1-4" class="outline-3">
<h3 id="sec-1-4">OpenEmbedded</h3>
<div class="outline-text-3" id="text-1-4">

<p><a href="http://www.openembedded.org/wiki/Main_Page">http://www.openembedded.org/wiki/Main_Page</a>
</p></div>

</div>

<div id="outline-container-1-5" class="outline-3">
<h3 id="sec-1-5">Poky Linux</h3>
<div class="outline-text-3" id="text-1-5">

<p><a href="http://www.pokylinux.org/">http://www.pokylinux.org/</a>
</p></div>

</div>

<div id="outline-container-1-6" class="outline-3">
<h3 id="sec-1-6">Root File system solutions</h3>
<div class="outline-text-3" id="text-1-6">

<p><a href="http://processors.wiki.ti.com/index.php/Linux_Toolchain#Root_File_System_solutions">http://processors.wiki.ti.com/index.php/Linux_Toolchain#Root_File_System_solutions</a>
</p>
</div>

</div>

<div id="outline-container-1-7" class="outline-3">
<h3 id="sec-1-7">Creating a Root File System for Linux on OMAP35x</h3>
<div class="outline-text-3" id="text-1-7">

<p><a href="http://processors.wiki.ti.com/index.php/Creating_a_Root_File_System_for_Linux_on_OMAP35x">http://processors.wiki.ti.com/index.php/Creating_a_Root_File_System_for_Linux_on_OMAP35x</a>
</p></div>

</div>

<div id="outline-container-1-8" class="outline-3">
<h3 id="sec-1-8">Initrd</h3>
<div class="outline-text-3" id="text-1-8">

<p><a href="http://processors.wiki.ti.com/index.php/Initrd">http://processors.wiki.ti.com/index.php/Initrd</a>
</p>
</div>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">Modify</h2>
<div class="outline-text-2" id="text-2">


</div>

<div id="outline-container-2-1" class="outline-3">
<h3 id="sec-2-1">Using The Correct Console Device</h3>
<div class="outline-text-3" id="text-2-1">

<p> update the <code>/etc/inittab</code> file in the filesystem used for kernel 
</p>


<pre class="src src-sh">S:2345:respawn:/sbin/getty 115200 ttyS2
by,
S:2345:respawn:/sbin/getty 115200 ttyO2
</pre>


</div>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">Arago</h2>
<div class="outline-text-2" id="text-3">


</div>

<div id="outline-container-3-1" class="outline-3">
<h3 id="sec-3-1">Setting Up Build Environment and build</h3>
<div class="outline-text-3" id="text-3-1">


</div>

<div id="outline-container-3-1-1" class="outline-4">
<h4 id="sec-3-1-1">ubuntu install dependency</h4>
<div class="outline-text-4" id="text-3-1-1">




<pre class="src src-sh">sudo apt-get install diffstat texi2html chrpath subversion python-psyco 
</pre>

</div>

</div>

<div id="outline-container-3-1-2" class="outline-4">
<h4 id="sec-3-1-2">Create the directory</h4>
<div class="outline-text-4" id="text-3-1-2">

<p>Create a new directory for the build environment:
</p>


<pre class="src src-sh">$ mkdir $<span style="color: #eedd82;">HOME</span>/oe
$ cd $<span style="color: #eedd82;">HOME</span>/oe
</pre>

</div>

</div>

<div id="outline-container-3-1-3" class="outline-4">
<h4 id="sec-3-1-3">Clone Arago repositories</h4>
<div class="outline-text-4" id="text-3-1-3">

<p>Now check out the following repositories:
</p>


<pre class="src src-sh">$ git clone git://arago-project.org/git/arago.git
$ git clone git://arago-project.org/git/arago-oe-dev.git
$ git clone git://arago-project.org/git/arago-bitbake.git
</pre>

<p>
The directory should now be populated with 3 subdirectories – <code>arago</code>, <code>arago-oe-dev</code> and <code>arago-bitbake</code>.
</p></div>

</div>

<div id="outline-container-3-1-4" class="outline-4">
<h4 id="sec-3-1-4">Copy setup/config files</h4>
<div class="outline-text-4" id="text-3-1-4">

<p>Arago repository comes with samples of arago/setenv and
arago/conf/local.conf files, which you can use as a starting point, by
copying them into their actual names (without .sample extension) and
modifying to suit your needs:
</p>


<pre class="src src-s">$ cp arago/setenv.sample arago/setenv
$ cp arago/conf/local.conf.sample arago/conf/local.conf
</pre>


<ul>
<li>File: <code>arago/setenv</code>
  Edit <code>arago/setenv</code> file and make sure environment variables are set
  properly. OEBASE should point to the directory you’ve created in the
  beginning:
</li>
</ul>




<pre class="src src-sh"><span style="color: #b0c4de;">export</span> <span style="color: #eedd82;">OEBASE</span>=$<span style="color: #eedd82;">HOME</span>/oe
</pre>

<ul>
<li>File: <code>arago/setenv</code>
  Also, in order to use a separate "scratch" area outside of home
  directory, you may want to enable SCRATCH variable and point it
  appropriately:
</li>
</ul>




<pre class="src src-sh"><span style="color: #b0c4de;">export</span> <span style="color: #eedd82;">SCRATCH</span>=/sim/scratch_AID
</pre>


</div>

</div>

<div id="outline-container-3-1-5" class="outline-4">
<h4 id="sec-3-1-5">Set the environment variables</h4>
<div class="outline-text-4" id="text-3-1-5">




<pre class="src src-sh">$ . arago/seten
</pre>

<p>
Or, 
</p>


<pre class="src src-sh">$ source arago/setenv
</pre>

</div>

</div>

<div id="outline-container-3-1-6" class="outline-4">
<h4 id="sec-3-1-6">Point to CSL toolchain</h4>
<div class="outline-text-4" id="text-3-1-6">

<p>If not done before, set the PATH variable to point to the CodeSourcery
toolchain (refer to <a href="http://www.mentor.com/embedded-software/codesourcery">Getting CodeSourcery Toolchain</a>(<a href="http://www.mentor.com/embedded-software/sourcery-tools/sourcery-codebench/lite/?cmpid=7108&amp;lite=arm&amp;target_os=GNU/Linux&amp;target_arch=ARM&amp;returnURL=https%3A%2F%2Fsourcery.mentor.com%2FGNUToolchain%2Frelease858%3Flite%3Darm%26cmpid%3D7108">The binary distribution for 2009q1-203 version</a>) for obtaining one):
</p>



<pre class="src src-sh">$ export <span style="color: #eedd82;">PATH</span>=/opt/arm-2009q1/bin:$<span style="color: #eedd82;">PATH</span>
</pre>


</div>

</div>

<div id="outline-container-3-1-7" class="outline-4">
<h4 id="sec-3-1-7">Build a minimal base filesystem</h4>
<div class="outline-text-4" id="text-3-1-7">

<p>Now it should be ready to start a build of the minimal filesystem
image:
</p>


<pre class="src src-sh">$ bitbake arago-base-image
</pre>

</div>

</div>

<div id="outline-container-3-1-8" class="outline-4">
<h4 id="sec-3-1-8">Build a "demo" filesystem for OMAP3 EVM</h4>
<div class="outline-text-4" id="text-3-1-8">




<pre class="src src-sh">$ <span style="color: #eedd82;">MACHINE</span>=omap3evm bitbake arago-console-image
</pre>

</div>

</div>

<div id="outline-container-3-1-9" class="outline-4">
<h4 id="sec-3-1-9">Build different kernels for supported platforms</h4>
<div class="outline-text-4" id="text-3-1-9">




<pre class="src src-sh">$ <span style="color: #eedd82;">MACHINE</span>=omap3evm bitbake virtual/kernel
$ <span style="color: #eedd82;">MACHINE</span>=beagleboard bitbake virtual/kernel
$ <span style="color: #eedd82;">MACHINE</span>=dm6446-evm bitbake virtual/kernel
$ <span style="color: #eedd82;">MACHINE</span>=dm355-evm bitbake virtual/kernel
</pre>

</div>

</div>

<div id="outline-container-3-1-10" class="outline-4">
<h4 id="sec-3-1-10">High-level hierarchy of arago-deploy directory</h4>
<div class="outline-text-4" id="text-3-1-10">

<p>Resulting images and packages will be placed under <code>arago-deploy</code>
directory - <code>images</code> for the filesystem, kernel and bootloader; and <code>ipk</code>
for binary IPK packages, respectively.
</p>



<pre class="src src-sh">arago-deploy
|-- images
|   |-- arago
|   |-- dm355-evm
|   |-- dm6446-evm
|   <span style="color: #fa8072;">`-- omap3evm</span>
<span style="color: #fa8072;">|-- ipk</span>
<span style="color: #fa8072;">|   |-- all</span>
<span style="color: #fa8072;">|   |-- arago</span>
<span style="color: #fa8072;">|   |-- armv5te</span>
<span style="color: #fa8072;">|   |-- armv7a</span>
<span style="color: #fa8072;">|   |-- dm355-evm</span>
<span style="color: #fa8072;">|   |-- dm6446-evm</span>
<span style="color: #fa8072;">|   |-- i686</span>
<span style="color: #fa8072;">|   |-- i686-armv5te-sdk</span>
<span style="color: #fa8072;">|   |-- i686-armv7a-sdk</span>
<span style="color: #fa8072;">|   `</span>-- omap3evm
<span style="color: #fa8072;">`-- sdk</span>
</pre>


</div>

</div>

<div id="outline-container-3-1-11" class="outline-4">
<h4 id="sec-3-1-11">Build individual package recipes</h4>
<div class="outline-text-4" id="text-3-1-11">

<p>You can also look in <code>oe/arago/recipes</code> for individual package recipes
that you can bitbake. For example:
</p>


<pre class="src src-sh">bitbake curl
bitbake thhtpd
</pre>


</div>

</div>

<div id="outline-container-3-1-12" class="outline-4">
<h4 id="sec-3-1-12">build a native compiler (on dm8168) using</h4>
<div class="outline-text-4" id="text-3-1-12">




<pre class="src src-sh"><span style="color: #eedd82;">MACHINE</span>=c6a816x-evm ./arago-bitbake/bin/bitbake gcc-4.3.3(since codesourcery is using 4.3.3) or
<span style="color: #eedd82;">MACHINE</span>=c6a816x-evm ./arago-bitbake/bin/bitbake task-sdk-native
</pre>

</div>
</div>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4">Host and Target</h2>
<div class="outline-text-2" id="text-4">

<p>After setting up opkg respository and pointing it to apache webserver
with my vmware, now allows me easy install of python, dropbear, perl,
etc cross-complied using code sourcery.
</p>
<p class="verse">
On Host:<br/>
Install Apache sudo apt-get install apache2<br/>
After you finish building packages on host, refresh the package index on the host: &gt; bitbake package-index<br/>
add a symlink to the arago deploy/ipk directory to apache's home page <code>/var/www/oe-repo</code><br/>
<br/>
On EVM:<br/>
Determine your host IP address, and then add a src/gz  line to <code>/etc/opkg/opkg.conf</code><br/>
On the device, re-fetch the package list : opkg update<br/>
On the device, search for packages or install them<br/>
<code>opkg list '*strace*'= =opkg install strace</code><br/>
</p>


</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5">Notes</h2>
<div class="outline-text-2" id="text-5">


</div>

<div id="outline-container-5-1" class="outline-3">
<h3 id="sec-5-1">Creating a Root File System for Linux on OMAP35x</h3>
<div class="outline-text-3" id="text-5-1">

<p><a href="http://processors.wiki.ti.com/index.php/Creating_a_Root_File_System_for_Linux_on_OMAP35x">http://processors.wiki.ti.com/index.php/Creating_a_Root_File_System_for_Linux_on_OMAP35x</a>
</p>

</div>

<div id="outline-container-5-1-1" class="outline-4">
<h4 id="sec-5-1-1">create the directory</h4>
<div class="outline-text-4" id="text-5-1-1">

<p>For simplicity, this note will
assume the user’s directory is “user”. The home directory is then
<code>/home/user</code>
</p>
<p>
All source code will be in the “src” directory, or
<code>/home/user/src</code>
</p>
<p>
Code will be built in the “build” directory, or
<code>/home/user/build</code>
</p>
<p>
The target root file system will be built in the “target” directory, or
<code>/home/user/target</code>
</p>
<p>
To create these directories, go to /home/user and enter
</p>


<pre class="src src-sh">[root@localhost user]# cd /home/user
[root@localhost user]# mkdir src
[root@localhost user]# mkdir build
[root@localhost user]# mkdir target
</pre>


</div>

</div>

<div id="outline-container-5-1-2" class="outline-4">
<h4 id="sec-5-1-2">Configure the Linux Kernel to Support File Systems</h4>
<div class="outline-text-4" id="text-5-1-2">

<p>The Linux kernel must be configured to support the file systems described in this note. To configure the kernel enter
“make menuconfig” on the command line.
</p>
<ul>
<li id="sec-5-1-2-1">Device Node Creation<br/>
The v2.6.22.x releases default to enabling <code>hotplug</code>, <code>sysfs</code>, and <code>tmpfs</code>.
To make sure hotplug is set, type in “make menuconfig” and from the
“Main menu” use the down arrow key to scroll down to the “General
setup” entry and press the Enter key to select it. Scroll down to
“Configure standard kernel features (for small systems)” and press the
Enter key. Scroll down to “Support for hot-pluggable devices” and make
sure it is set. The Space Bar selects and de-selects options. A sample
sub-menu is shown below:




<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; Configure standard kernel features (<span style="color: #00ffff;">for</span> small systems) &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
&#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
&#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
&#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
&#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
&#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
&#9474; &#9474;    --- Configure standard kernel features (<span style="color: #00ffff;">for</span> small systems)       &#9474; &#9474;
&#9474; &#9474;    [*]   Enable 16-bit UID system calls                             &#9474; &#9474;
&#9474; &#9474;    [ ]   Sysctl syscall support                                     &#9474; &#9474;
&#9474; &#9474;    [*]   Load all symbols for debugging/ksymoops                    &#9474; &#9474;
&#9474; &#9474;    [ ]     Include all symbols<span style="color: #00ffff;"> in</span> kallsyms                          &#9474; &#9474;
&#9474; &#9474;    [*]     Do an extra kallsyms pass                                &#9474; &#9474;
&#9474; &#9474;    [*]   Support for hot-pluggable devices                          &#9474; &#9474;
&#9474; &#9474;    [*]   Enable support for printk                                  &#9474; &#9474;
&#9474; &#9474;    [*]   BUG() support                                              &#9474; &#9474;
&#9474; &#9474;    [*]   Enable ELF core dumps                                      &#9474; &#9474;
&#9474; &#9492;&#9472;&#9472;&#9472;&#9472;v(+)&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;
&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;
&#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;
</pre>


<p>
To ensure sysfs and tmpfs are selected, start back at the “Main menu”
and scroll down to the “File systems” option. Press Enter to select it
and then scroll down to the “Pseudo filesystems” option and press
Enter to select it. The file systems selected here should be: /proc,
/proc/sys, sysfs, and “Virtual memory file system support.” That last
one is also referred to as /tmpfs. A sample sub-menu is shown below.
</p>


<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; Pseudo filesystems &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
&#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
&#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
&#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
&#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
&#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
&#9474; &#9474;    [*] /proc file system support                                    &#9474; &#9474;
&#9474; &#9474;    [*]   Sysctl support (/proc/sys)                                 &#9474; &#9474;
&#9474; &#9474;    [*] sysfs file system support                                    &#9474; &#9474;
&#9474; &#9474;    [*] Virtual memory file system support (former shm fs)           &#9474; &#9474;
&#9474; &#9474;    [ ]   Tmpfs POSIX Access Control Lists                           &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Userspace-driven configuration filesystem (EXPERIMENTAL)     &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;
&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;
&#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;
&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
</pre>

</li>
</ul>
<ul>
<li id="sec-5-1-2-2">Configure the Linux Kernel for Root File System over NFS<br/>
From the “Main Menu” use the down arrow to scroll down to “File
systems” and select it by pressing the Enter key. Under “File Systems”
scroll down to “Network file systems” and select it. On this page make
sure that “NFS file system support”, “Provide NFSv3 client support”,
“Provide NFSv4 client support,” and “Root file system on NFS” are
selected. A sample sub-menu is shown below.




<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; Network File Systems &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
 &#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
 &#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
 &#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
 &#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
 &#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
 &#9474; &#9474;    &lt;*&gt; NFS file system support                                      &#9474; &#9474;
 &#9474; &#9474;    [*]   Provide NFSv3 client support                               &#9474; &#9474;
 &#9474; &#9474;    [ ]     Provide client support for the NFSv3 ACL protocol extensi&#9474; &#9474;
 &#9474; &#9474;    [*]   Provide NFSv4 client support (EXPERIMENTAL)                &#9474; &#9474;
 &#9474; &#9474;    [ ]   Allow direct I/O on NFS files                              &#9474; &#9474;
 &#9474; &#9474;    &lt; &gt; NFS server support                                           &#9474; &#9474;
 &#9474; &#9474;    [*] Root file system on NFS                                      &#9474; &#9474;
 &#9474; &#9474;    [ ] Support for rpcbind versions 3 &amp; 4 (EXPERIMENTAL)            &#9474; &#9474;
 &#9474; &#9474;    --- Secure RPC: Kerberos V mechanism (EXPERIMENTAL)              &#9474; &#9474;
 &#9474; &#9474;    &lt; &gt; Secure RPC: SPKM3 mechanism (EXPERIMENTAL)                   &#9474; &#9474;
 &#9474; &#9492;&#9472;&#9472;&#9472;&#9472;v(+)&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;
 &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;
 &#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;
 &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
</pre>

</li>
</ul>
<ul>
<li id="sec-5-1-2-3">Configure the Linux Kernel for RAMDISK support<br/>
In this configuration the u-boot boot loader is used to download a
binary image to RAM and pass parameters to the kernel telling it the
root file system is on a ramdisk, where it is located, and its size.
From the “Main menu” scroll down to “Device Drivers” and select it.
Then scroll down to “Block devices” and select it. On this sub-menu
make sure “RAM disk support” is selected. For the “Default RAM disk
size” enter 16384. The RAM disk built in this note is 16M.



<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; Block devices &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
&#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
&#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
&#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
&#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
&#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
&#9474; &#9474;    &lt;*&gt; Loopback device support                                      &#9474; &#9474;
&#9474; &#9474;    &lt; &gt;   Cryptoloop Support                                         &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Network block device support                                 &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Low Performance USB Block driver                             &#9474; &#9474;
&#9474; &#9474;    &lt;*&gt; RAM disk support                                             &#9474; &#9474;
&#9474; &#9474;    (16)  Default number of RAM disks                                &#9474; &#9474;
&#9474; &#9474;    (16384) Default RAM disk size (kbytes)                           &#9474; &#9474;
&#9474; &#9474;    (1024) Default RAM disk block size (bytes)                       &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Packet writing on CD/DVD media                               &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; ATA over Ethernet support                                    &#9474; &#9474;
&#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;
&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;
&#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;
&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
</pre>


<p>
The step above configures the kernel for build in a ramdisk. Now go
back to the “Main menu” and again select “General setup.” Scroll down
and make sure “Initial RAM filesystem and RAM disk (initramfs/initrd)
support” is selected. By default in the T.I. kernel it is.
</p>


<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; General setup &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
&#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
&#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
&#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
&#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
&#9474; &#9484;&#9472;&#9472;&#9472;&#9472;^(-)&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
&#9474; &#9474;    [ ] Auditing support                                             &#9474; &#9474;
&#9474; &#9474;    &lt;*&gt; Kernel .config support                                       &#9474; &#9474;
&#9474; &#9474;    [*] Enable access to .config through /proc/config.gz             &#9474; &#9474;
&#9474; &#9474;    (14) Kernel log buffer size (<span style="color: #eedd82;">16</span> =&gt; 64KB, <span style="color: #eedd82;">17</span> =&gt; 128KB)            &#9474; &#9474;
&#9474; &#9474;    [*] Create deprecated sysfs files                                &#9474; &#9474;
&#9474; &#9474;    [ ] Kernel-&gt;user space relay support (formerly relayfs)          &#9474; &#9474;
&#9474; &#9474;    [*] Initial RAM filesystem and RAM disk (initramfs/initrd) suppor&#9474; &#9474;
&#9474; &#9474;    ()    Initramfs source file(s)                                   &#9474; &#9474;
&#9474; &#9474;    [*] Optimize for size (Look out for broken compilers!)           &#9474; &#9474;
&#9474; &#9474;    [*] Configure standard kernel features (<span style="color: #00ffff;">for</span> small systems)  ---&gt; &#9474; &#9474;
&#9474; &#9474;        Choose SLAB allocator (SLAB)  ---&gt;                           &#9474; &#9474;
&#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;
&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;
&#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;
&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
</pre>

</li>
</ul>
<ul>
<li id="sec-5-1-2-4">Configure the Linux Kernel for Memory Technology Devices (MTD)<br/>
To use any of the flash file systems, such as JFFS2 or CRAMFS, the MTD
layer must be configured. MTD are typically flash devices used for
storage. Configuring the individual drivers can be tricky. If a device
is CFI compliant then all that is needed is to select the CFI options.
In this example, CFI is selected, as is Intel/Sharp just in case the
part it not CFI compliant. Starting at the “Main menu” scroll down to
“Device Drivers” and select it. Scroll down to “Memory Technology
Devices (MTD) support” and select it. There are numerous options that
can/should be selected. The screen captures below are length



<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; Memory Technology Device (MTD) support &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
&#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
&#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
&#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
&#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
&#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
&#9474; &#9474;    --- Memory Technology Device (MTD) support                       &#9474; &#9474;
&#9474; &#9474;    [ ]   Debugging                                                  &#9474; &#9474;
&#9474; &#9474;    &lt;*&gt;   MTD concatenating support                                  &#9474; &#9474;
&#9474; &#9474;    [*]   MTD partitioning support                                   &#9474; &#9474;
&#9474; &#9474;    &lt; &gt;     RedBoot partition table parsing                          &#9474; &#9474;
&#9474; &#9474;    [*]     Command line partition table parsing                     &#9474; &#9474;
&#9474; &#9474;    &lt; &gt;     ARM Firmware Suite partition parsing                     &#9474; &#9474;
&#9474; &#9474;    ---   User Modules And Translation Layers                        &#9474; &#9474;
&#9474; &#9474;    &lt;*&gt;   Direct char device access to MTD devices                   &#9474; &#9474;
&#9474; &#9474;    ---   Common interface to block layer for MTD <span style="color: #ffa07a;">'translation layers&#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt;*&gt;   Caching block device access to MTD devices                 &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt; &gt;   FTL (Flash Translation Layer) support                      &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt; &gt;   NFTL (NAND Flash Translation Layer) support                &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt; &gt;   INFTL (Inverse NAND Flash Translation Layer) support       &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt; &gt;   Resident Flash Disk (Flash Translation Layer) support      &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt; &gt;   NAND SSFDC (SmartMedia) read only translation layer        &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;          RAM/ROM/Flash chip drivers  ---&gt;                           &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;          Mapping drivers for chip access  ---&gt;                      &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;          Self-contained MTD device drivers  ---&gt;                    &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt;*&gt;   NAND Device Support  ---&gt;                                  &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;    &lt;*&gt;   OneNAND Device Support  ---&gt;                               &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9474;          UBI - Unsorted block images  ---&gt;                          &#9474; &#9474;</span>
<span style="color: #ffa07a;">&#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;</span>
<span style="color: #ffa07a;">&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;</span>
<span style="color: #ffa07a;">&#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;</span>
<span style="color: #ffa07a;">&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span>
</pre>

<p>
Select the “RAM/ROM/Flash chip drivers” and ensure CFI and Intel/Sharp
are selected.
</p>


<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; RAM/ROM/Flash chip drivers &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
&#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
&#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
&#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
&#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
&#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
&#9474; &#9474;    &lt;*&gt; Detect flash chips by Common Flash Interface (CFI) probe     &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Detect non-CFI AMD/JEDEC-compatible flash chips              &#9474; &#9474;
&#9474; &#9474;    [ ] Flash chip driver advanced configuration options             &#9474; &#9474;
&#9474; &#9474;    &lt;*&gt; Support for Intel/Sharp flash chips                          &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Support for AMD/Fujitsu flash chips                          &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Support for ST (Advanced Architecture) flash chips           &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Support for RAM chips<span style="color: #00ffff;"> in</span> bus mapping                         &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Support for ROM chips<span style="color: #00ffff;"> in</span> bus mapping                         &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Support for absent chips<span style="color: #00ffff;"> in</span> bus mapping                      &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;
&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;
&#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;
&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
</pre>

<p>
Finally, go back to the MTD menu and select the “Mapping drivers for
chip access” option. This option enables the partitioning of the MTD
into four partitions: u-boot, u-boot environment, kernel, and file
system.
</p>


<pre class="src src-sh">&#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472; Mapping drivers for chip access &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;
&#9474;  Arrow keys navigate the menu.  &lt;Enter&gt; selects submenus ---&gt;.          &#9474;
&#9474;  Highlighted letters are hotkeys.  Pressing &lt;Y&gt; includes, &lt;N&gt; excludes, &#9474;
&#9474;  &lt;M&gt; modularizes features.  Press &lt;Esc&gt;&lt;Esc&gt; to exit, &lt;?&gt; for Help, &lt;/&gt; &#9474;
&#9474;  for Search.  Legend: [*] built-in  [ ] excluded  &lt;M&gt; module  &lt; &gt;       &#9474;
&#9474; &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488; &#9474;
&#9474; &#9474;    [ ] Support non-linear mappings of flash chips                   &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; CFI Flash device<span style="color: #00ffff;"> in</span> physical memory map                      &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; CFI Flash device mapped on ARM Integrator/P720T              &#9474; &#9474;
&#9474; &#9474;    &lt;*&gt; TI OMAP board mappings                                       &#9474; &#9474;
&#9474; &#9474;    &lt; &gt; Map driver for platform device RAM (mtd-ram)                 &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9474;                                                                     &#9474; &#9474;
&#9474; &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496; &#9474;
&#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9508;
&#9474;                    &lt;Select&gt;    &lt; Exit &gt;    &lt; Help &gt;                     &#9474;
&#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;
</pre>


</li>
</ul>
</div>

</div>

<div id="outline-container-5-1-3" class="outline-4">
<h4 id="sec-5-1-3">Download and Build BusyBox</h4>
<div class="outline-text-4" id="text-5-1-3">

<p>The source to BusyBox can be downloaded from
<a href="http://www.busybox.net/downloads">http://www.busybox.net/downloads</a>. Download <code>busybox-1.20.2.tar.bz2</code> to the /home/user/src
directory. Change directory to the build directory and extract the
source code with the tar utility. 
</p>



<pre class="src src-sh">[root@localhost src]# cd ../build
[root@localhost build]# tar -xjvf ../src/busybox-1.20.2.tar.bz2
</pre>


<p>
And then:
</p>


<pre class="src src-sh">[root@localhost build]# cd busybox-1.20.2
[root@localhost busybox-1.2.2.1]# make menuconfig
</pre>


<p>
To build BusyBox, simply type in make at the command line. After a few
minutes the compile should be complete. When compilation is complete
install BusyBox to the target directory. The make and install commands
are show below:
</p>


<pre class="src src-sh">[root@localhost busybox-1.2.2.1]# make
[root@localhost busybox-1.2.2.1]# make <span style="color: #eedd82;">CONFIG_PREFIX</span>=/home/user/target install
</pre>


</div>

</div>

<div id="outline-container-5-1-4" class="outline-4">
<h4 id="sec-5-1-4">Configure the New Target Root File System</h4>
<div class="outline-text-4" id="text-5-1-4">

<p>Looking at the newly built root file system, there are only three
subdirectories of binaries and a symbolic link of bin/busybox to
linuxrc. More directories must be created before the file system can
be used. Some device nodes should be created, too.
</p>


<pre class="src src-sh">[root@localhost bin]# cd /home/user/target/
[root@localhost target]# dir
total 28
drwxr-xr-x  2 root root 4096 Nov 21 10:20 bin
lrwxrwxrwx  1 root root   11 Nov 21 10:20 linuxrc -&gt; bin/busybox
drwxr-xr-x  2 root root 4096 Nov 21 10:20 sbin
drwxr-xr-x  4 root root 4096 Nov 21 10:20 usr
</pre>

<ul>
<li>Create the dev, dev/pts, etc, etc/init.d, lib, mnt, opt, proc, root,
  sys, tmp, var, and var/log directories. Also create the device node
  for the initial console.



<pre class="src src-sh">[root@localhost target]# mkdir dev
[root@localhost target]# mknod dev/console c 5 1
[root@localhost target]# mkdir dev/pts
[root@localhost target]# mkdir etc
[root@localhost target]# mkdir etc/init.d
[root@localhost target]# mkdir lib
[root@localhost target]# mkdir mnt
[root@localhost target]# mkdir opt
[root@localhost target]# mkdir proc
[root@localhost target]# mkdir root
[root@localhost target]# mkdir sys
[root@localhost target]# mkdir tmp
[root@localhost target]# mkdir var
[root@localhost target]# mkdir var/log
</pre>

</li>
<li>To have the /proc and /dev/pts file systems mounted at boot time,
  the file etc/fstab must be created in the etc directory. 



<pre class="src src-sh">[root@localhost target]# cd etc
[root@localhost etc]# vi fstab
proc            /proc           proc    defaults        0 0
none            /dev/pts        devpts  <span style="color: #eedd82;">mode</span>=0622       0 0
</pre>

</li>
<li>The login utilities use the files group, hosts, and passwd in the
  etc directory for logging in. For now, only root needs to be defined
  in group and passwd while hosts just needs to have localhost
  defined. 



<pre class="src src-sh">[root@localhost etc]# vi group
root:x:0:root

[root@localhost etc]# vi passwd
root::0:0:root:/root:/bin/ash 

[root@localhost etc]# vi hosts
127.0.0.1       localhost
</pre>

</li>
<li>The kernel starts “/sbin/init” after it boots.Init reads the
  etc/inittab file to determine what to do at start up, shutdown, or
  when a user logs in. These inittab files can get quite complicated.
  A simple one is shown below:



<pre class="src src-sh">[root@localhost etc]# vi inittab
::sysinit:/etc/init.d/rcS 

<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">/bin/ash</span>
<span style="color: #ff7f24;">#</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">Start an "askfirst" shell on the serial port</span>
console::askfirst:-/bin/ash

<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">Stuff to do when restarting the init process</span>
::restart:/sbin/init

<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">Stuff to do before rebooting</span>
::ctrlaltdel:/sbin/reboot
::shutdown:/bin/umount -a -r
::shutdown:/sbin/swapoff -a
</pre>

<p>
  The “sysinit” line tells init to run the /etc/init.d/rcS script to set
  up the system. 
</p>
<p>
  A simple etc/init.d/rcS file could assume file systems existed in the
  kernel and would simply mount the mount points as needed. A more
  complicated one would test for the existence of file systems and if
  found, mount them; if not found, find ways to still get the system
  booted.
</p>
<p>
  The author has taken the etc/init.d/rcS and mdev.conf files from the
  V2.6.22.18-OMAP3 release for a simple example. The rcS script will
  test for the existence of file systems and mount them accordingly.
</p>


<pre class="src src-sh">[root@localhost etc]# vi init.d/rcS

<span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/sh</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Common settings</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #eedd82;">HOSTNAME</span>=OMAP3EVM
<span style="color: #eedd82;">VERSION</span>=1.0.0

hostname $<span style="color: #eedd82;">HOSTNAME</span>

<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Prints execution status.</span>
<span style="color: #ff7f24;">#</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">arg1 : Execution status</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">arg2 : Continue (0) or Abort (1) on error</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #87cefa;">status</span> ()
{
       <span style="color: #00ffff;">if</span> [ $<span style="color: #eedd82;">1</span> -eq 0 ] ; <span style="color: #00ffff;">then</span>
               <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"[SUCCESS]"</span>
       <span style="color: #00ffff;">else</span>
               <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"[FAILED]"</span>

               <span style="color: #00ffff;">if</span> [ $<span style="color: #eedd82;">2</span> -eq 1 ] ; <span style="color: #00ffff;">then</span>
                       <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"... System init aborted."</span>
                       <span style="color: #00ffff;">exit</span> 1
               <span style="color: #00ffff;">fi</span>
       <span style="color: #00ffff;">fi</span>

}

<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Get verbose</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">""</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"    System initialization..."</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">""</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"    Hostname       : $HOSTNAME"</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"    Filesystem     : v$VERSION"</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">""</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">""</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"    Kernel release : `uname -s` `uname -r`"</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"    Kernel version : `uname -v`"</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">""</span>


<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">MDEV Support</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">(Requires sysfs support in the kernel)</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Mounting /proc             : "</span>
mount -n -t proc /proc /proc
status $<span style="color: #eedd82;">?</span> 1

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Mounting /sys              : "</span>
mount -n -t sysfs sysfs /sys
status $<span style="color: #eedd82;">?</span> 1

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Mounting /dev              : "</span>
mount -n -t tmpfs mdev /dev
status $<span style="color: #eedd82;">?</span> 1

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Mounting /dev/pts          : "</span>
mkdir /dev/pts
mount -t devpts devpts /dev/pts
status $<span style="color: #eedd82;">?</span> 1

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Enabling hot-plug          : "</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"/sbin/mdev"</span> &gt; /proc/sys/kernel/hotplug
status $<span style="color: #eedd82;">?</span> 0

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Populating /dev            : "</span>
mkdir /dev/input
mkdir /dev/snd

mdev -s
status $<span style="color: #eedd82;">?</span> 0

<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Disable power management</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">(Requires sysfs support in the kernel)</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">echo -n " Disabling Power mgmt       : "</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">echo -n "1" &gt; /sys/power/cpuidle_deepest_state</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">status $? 1</span>

<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Turn off LCD after 1 hour of inactivity</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">(Requires sysfs support in the kernel)</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">echo -n " Turn off LCD after 1 hour  : "</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">echo -n "3600" &gt; /sys/power/fb_timeout_value</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">status $? 1</span>


<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Mount the default file systems</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Mounting other filesystems : "</span>
mount -a
status $<span style="color: #eedd82;">?</span> 0


<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Set PATH</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #b0c4de;">export</span> <span style="color: #eedd82;">PATH</span>=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin


<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Start other daemons</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Starting syslogd           : "</span>
/sbin/syslogd
status $<span style="color: #eedd82;">?</span> 0

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Starting telnetd           : "</span>
/usr/sbin/telnetd
status $<span style="color: #eedd82;">?</span> 0


<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Done!</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">""</span>
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"System initialization complete."</span>


<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">Start demo app</span>
<span style="color: #ff7f24;">#   </span><span style="color: #ff7f24;">---------------------------------------------</span>
<span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">if [[ -x /etc/init.d/demo_start ]]; then</span>
<span style="color: #ff7f24;">#       </span><span style="color: #ff7f24;">echo " Starting Demo Application..."</span>
<span style="color: #ff7f24;">#       </span><span style="color: #ff7f24;">/etc/init.d/demo_start &amp;</span>
<span style="color: #ff7f24;">#       </span><span style="color: #ff7f24;">sleep 5</span>
<span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">fi</span>
Please note that<span style="color: #00ffff;"> in</span> more recent kernels (2.6.29 and newer) the sysfs entries shown above to disable power management and control the LCD inactivity timeout shown above have been removed. For latest details on using OMAP Power Management<span style="color: #00ffff;"> in</span> Linux please refer to this article.

To automatically mount the debugfs on start-up the following can be added to the above rcS file. Please note that the debugfs needs to be selected<span style="color: #00ffff;"> in</span> the kernel configuration and built into the kernel before you can mount it. The below script checks to see if the debugfs is supported by the kernel before attempting to mount the file-system. To enable the debugfs run <span style="color: #ffa07a;">"make menuconfig"</span> and go to <span style="color: #ffa07a;">"Kernel Hacking"</span> and select <span style="color: #ffa07a;">"Debug Filesystem"</span>.

cat /proc/filesystems | grep -q debugfs
<span style="color: #00ffff;">if</span> [ $<span style="color: #eedd82;">?</span> -eq 0 ] ; <span style="color: #00ffff;">then</span>
        <span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Mounting /debug             : "</span>
        mount -n -t debugfs none /debug
        status $<span style="color: #eedd82;">?</span> 1
<span style="color: #00ffff;">fi</span>
</pre>


<p>  
  To automatically mount the debugfs on start-up the following can be
  added to the above rcS file. Please note that the debugfs needs to
  be selected in the kernel configuration and built into the kernel
  before you can mount it. The below script checks to see if the
  debugfs is supported by the kernel before attempting to mount the
  file-system. To enable the debugfs run "make menuconfig" and go to
  "Kernel Hacking" and select "Debug Filesystem".
</p>


<pre class="src src-sh">cat /proc/filesystems | grep -q debugfs
<span style="color: #00ffff;">if</span> [ $<span style="color: #eedd82;">?</span> -eq 0 ] ; <span style="color: #00ffff;">then</span>
        <span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">" Mounting /debug             : "</span>
        mount -n -t debugfs none /debug
        status $<span style="color: #eedd82;">?</span> 1
<span style="color: #00ffff;">fi</span>
</pre>

<p>
  After saving the file, change its access permissions so that it is executable for all.
</p>


<pre class="src src-sh">[root@localhost etc]# vi mdev.conf

audio       0:5 0666
console     0:5 0600
control.*   0:0 0660 @/bin/mv /dev/$<span style="color: #eedd82;">MDEV</span> /dev/snd/
dsp         0:5 0666
event.*     0:0 0600 @/bin/mv /dev/$<span style="color: #eedd82;">MDEV</span> /dev/input/
fb          0:5 0666
nfs         0:5 0770
null        0:0 0777
pcm.*       0:0 0660 @/bin/mv /dev/$<span style="color: #eedd82;">MDEV</span> /dev/snd/
rtc         0:0 0666
tty         0:5 0660
tty0*       0:5 0660
tty1*       0:5 0660
tty2*       0:5 0660
tty3*       0:5 0660
tty4*       0:5 0660
tty5*       0:5 0660
tty6*       0:5 0660
ttyS*       0:5 0640
urandom     0:0 0444
zero        0:0 0666
</pre>

</li>
</ul>



</div>

</div>

<div id="outline-container-5-1-5" class="outline-4">
<h4 id="sec-5-1-5">Add the Shared Libraries Applications will Require</h4>
<div class="outline-text-4" id="text-5-1-5">

<p>In the Code Sourcery tool chain, most of the libraries are found in
the <code>/home/testbed/CodeSourcery/Sourcery_G++_Lite/arm-none-linux-gnueabi/libc/lib</code> directory. Simply
copy these files to the root file system, maintaining symbolic links
and then strip out unneeded debug information.
</p>



<pre class="src src-sh">[root@localhost user]# cd /home/user/target/lib
[root@localhost lib]# cp &#8211;r /home/testbed/CodeSourcery/Sourcery_G++_Lite/arm-none-linux-gnueabi/libc/lib/* .
[root@localhost lib]# arm-none-linux-gnueabi-strip *
</pre>

<p>
Some libraries might be in other directories in the tool chain; those
would have to be found on a “trial and error” basis when applications
do not load because of a missing shared library.
</p></div>

</div>

<div id="outline-container-5-1-6" class="outline-4">
<h4 id="sec-5-1-6">Mounting the Root File System over NFS</h4>
<div class="outline-text-4" id="text-5-1-6">

</div>

</div>

<div id="outline-container-5-1-7" class="outline-4">
<h4 id="sec-5-1-7">Enhancing the Root File System</h4>
<div class="outline-text-4" id="text-5-1-7">

<p>Any drivers built as modules need to be added to the target root file
system
</p>


<pre class="src src-sh">[root@localhost 2.6_kernel]# make modules
[root@localhost 2.6_kernel]# make <span style="color: #eedd82;">INSTALL_MOD_PATH</span>=/home/user/target modules_install
</pre>


<p>
One problem still exists – the modules still have debug information so
they are larger than they need to be. When debug information is no
longer needed, use the arm-none-linux-gnueabi-strip utility to remove
it. 
</p>


<pre class="src src-sh">[root@localhost user]# cd /home/user/target/lib/modules
[root@localhost modules]# arm-none-linux-gnueabi-strip <span style="color: #fa8072;">`find . &#8211;name &#8220;*.ko&#8221;`</span>
</pre>

</div>
</div>
</div>
</div>
</div>

<div id="postamble">
<p class="date">Date: 2012-09-09 15:16:53 HKT</p>
<p class="author">Author: Shi Shougang</p>
<p class="creator">Org version 7.8.09 with Emacs version 24</p>
<a href="http://validator.w3.org/check?uri=referer">Validate XHTML 1.0</a>

</div>
</body>
</html>
